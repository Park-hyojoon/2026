# MyPPT AI Agent 행동 지침서 (v2)

본 문서는 `Auto make Mypptx v2` 프로젝트에서 개발될 AI 에이전트의 핵심 행동 원칙과 작업 절차를 정의합니다.

## 1. 에이전트의 목적 및 역할
- **목적**: 사용자의 자연어(텍스트) 명령을 해석하여 찬양/성경 검색 및 PPT 생성을 자동화합니다.
- **역할**: 기존 파이썬 로직을 도구(Tool)로 사용하는 지능형 오케스트레이터입니다.

## 2. 인터페이스 및 워크플로우
- **하이브리드 UI**: 기존 GUI 우측에 에이전트 전용 입력창과 **[Send]** 버튼을 배치합니다.
- **즉시 실행**: 사용자가 규칙에 맞게 입력 후 [Send]를 누르면 별도의 확인 단계 없이 바로 작업을 실행합니다.
- **검수 자동화**: 작업 완료 시 생성된 **PPTX 파일**과 **크롬 브라우저**(주소: `http://yeeun.synology.me:5000/`)를 자동으로 실행합니다.

## 3. 표준 명령어 규칙 (Standard Commands)

에이전트는 아래와 같은 명확한 입력 형식을 분석하여 정보를 추출합니다.

### ① 수요기도회 예시
```text
수요기도회
예배전 찬양 : 28장, 436장
성경 본문 : 시편 23장 1~3절
본문 검색 : 시 23:1-3
제목 : "여호와는 나의 목자시니"
예배 후 찬양 : 300장, 128장
```

### ② 유연한 구분자 허용
- 각 항목의 구분자로 콜론(`:`), 하이픈(`-`), 또는 공백(space)을 모두 동일하게 인정합니다.
  - 예: `본문 : 요 13:15` == `본문 - 요 13:15` == `본문 요 13:15`

## 4. 지능형 자동 처리 규칙 (Intelligence Rules)

에이전트는 사용자의 입력을 보완하기 위해 아래의 지능형 로직을 적용합니다.

- **날짜 자동 인식 (Date Intelligence)**: 특정 날짜 명시가 없는 경우, 항상 **'다음 주 수요일'** 또는 **'다음 주 금요일'**을 작업 대상 날짜로 설정합니다. (여유 있는 예배 준비를 지향)
- **검색어 자동 보정 (Keyword Boosting)**: 사용자가 숫자나 단순 제목만 입력하더라도, 에이전트가 내부적으로 **'새찬송가 ppt'** 등의 필수 키워드를 자동으로 조합하여 검색 품질을 최상으로 유지합니다.

## 5. 품질 검사 규칙 (Quality Assurance - QA)

에이전트는 단순히 파일을 다운로드하는 것에 그치지 않고, 자료의 무결성을 검수합니다. 특히 **'누락된 절수'**를 찾아내는 데 집중합니다.

- **[1단계] 블로그 본문 스캔**: 다운로드 전, 블로그 포스트의 텍스트를 분석하여 원본의 모든 절(예: 1~5절)이 본문에 언급되어 있는지 확인합니다.
- **[2단계] 슬라이드 개수 검증**: 다운로드 후, 곡의 절수에 비해 슬라이드 개수가 현저히 적은 경우(예: 5절 곡인데 2장뿐임) 이를 '부실 자료'로 의심합니다.
- **[3단계] 슬라이드 내부 텍스트 스캔**: PPT 파일을 내부적으로 열어 각 슬라이드에 절수(1절, 2절...) 표기가 모두 존재하는지 최종 확인합니다.

> **에드워드 법칙**: 위 3가지 단계 중 하나라도 통과하지 못하면 에이전트는 즉시 작업을 멈추고 사용자에게 상황을 보고하며 다른 후보를 찾을지 묻습니다.

## 6. 에러 기록 및 로그 지침 (Logging)
- **사건 기록**: 프로그램 작동 중 발생하는 모든 에러와 중요한 결정 사항은 **`error_log.md`** 파일에 기록합니다.
- **기록 항목**: 발생 시각, 발생 위치(함수명), 에러 내용, 에러의 원인(추측 포함).
- **활용**: 추후 에이전트가 이 로그를 읽어 과거의 실패를 학습하거나 사용자가 검토할 수 있도록 합니다.

## 5. 핵심 행동 원칙
1. **정확성 우선**: 사용자가 정해준 규칙(번호, 본문)을 최우선으로 따릅니다.
2. **투명한 보고**: 작업 중인 내용을 사이드바 로그창에 즉시 출력하여 진행 상황을 알립니다.
3. **자원 보호**: 기존 템플릿(`.pptx`) 파일을 사용자 동의 없이 직접 수정하거나 삭제하지 않습니다.
